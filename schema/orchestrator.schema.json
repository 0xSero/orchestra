{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OpenCode Orchestrator Config",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "basePort": { "type": "number", "default": 14096 },
    "autoSpawn": { "type": "boolean", "default": true },
    "startupTimeout": { "type": "number", "default": 30000 },
    "healthCheckInterval": { "type": "number", "default": 30000 },
    "ui": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "toasts": { "type": "boolean", "default": true },
        "injectSystemContext": { "type": "boolean", "default": true },
        "systemContextMaxWorkers": { "type": "number", "default": 12 },
        "defaultListFormat": { "type": "string", "enum": ["markdown", "json"], "default": "markdown" }
      }
    },
    "notifications": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "idle": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "title": { "type": "string" },
            "message": { "type": "string" },
            "delayMs": { "type": "number", "default": 1500 }
          }
        }
      }
    },
    "agent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "name": { "type": "string", "default": "orchestrator" },
        "model": { "type": "string" },
        "prompt": { "type": "string" },
        "mode": { "type": "string", "enum": ["primary", "subagent"], "default": "primary" },
        "color": { "type": "string" }
      }
    },
    "commands": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "prefix": { "type": "string", "default": "orchestrator." }
      }
    },
    "pruning": {
      "type": "object",
      "additionalProperties": false,
      "description": "DCP-inspired context pruning (truncates large tool inputs/outputs before sending to the LLM).",
      "properties": {
        "enabled": { "type": "boolean", "default": false },
        "maxToolOutputChars": { "type": "number", "default": 12000 },
        "maxToolInputChars": { "type": "number", "default": 4000 },
        "protectedTools": { "type": "array", "items": { "type": "string" }, "default": ["task", "todowrite", "todoread"] }
      }
    },
    "workflows": {
      "type": "object",
      "additionalProperties": false,
      "description": "Workflow system configuration (multi-step orchestrations that delegate to workers).",
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "allow": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Optional allow-list of workflow IDs. If set, only these workflows can be executed."
        },
        "roocodeBoomerang": {
          "type": "object",
          "additionalProperties": false,
          "description": "Built-in Roocode sequential boomerang workflow defaults/overrides.",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "maxSteps": { "type": "number", "default": 4 },
            "perStepTimeoutMs": { "type": "number", "default": 120000 },
            "maxTaskChars": { "type": "number", "default": 12000 },
            "maxCarryChars": { "type": "number", "default": 24000 },
            "steps": {
              "type": "array",
              "description": "Advanced: override the default step sequence.",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["id", "profileId", "prompt"],
                "properties": {
                  "id": { "type": "string" },
                  "profileId": { "type": "string" },
                  "prompt": { "type": "string" },
                  "forwardAttachments": { "type": "boolean", "default": false }
                }
              }
            }
          }
        }
      }
    },
    "security": {
      "type": "object",
      "additionalProperties": false,
      "description": "Security hardening knobs.",
      "properties": {
        "blockSecretsInMemory": { "type": "boolean", "default": true },
        "attachments": {
          "type": "object",
          "additionalProperties": false,
          "description": "Attachment limits (applied to path/base64 attachments).",
          "properties": {
            "allowFileAttachments": { "type": "boolean", "default": false },
            "maxFileBytes": { "type": "number", "default": 10485760 },
            "maxBase64Chars": { "type": "number", "default": 14680064 },
            "maxAttachments": { "type": "number", "default": 8 }
          }
        }
      }
    },
    "profiles": {
      "type": "array",
      "description": "Profiles available to spawn. Use this to set workerâ†’model mapping without auto-spawning.",
      "items": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "object",
            "additionalProperties": false,
            "required": ["id"],
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "model": { "type": "string" },
              "providerID": { "type": "string" },
              "purpose": { "type": "string" },
              "whenToUse": { "type": "string" },
              "systemPrompt": { "type": "string" },
              "port": { "type": "number" },
              "supportsVision": { "type": "boolean" },
              "supportsWeb": { "type": "boolean" },
              "temperature": { "type": "number" },
              "tags": { "type": "array", "items": { "type": "string" } },
              "tools": {
                "type": "object",
                "additionalProperties": { "type": "boolean" }
              }
            }
          }
        ]
      }
    },
    "workers": {
      "type": "array",
      "description": "Workers to auto-spawn. Items may be built-in IDs (string) or full profile objects.",
      "items": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "object",
            "additionalProperties": false,
            "required": ["id"],
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "model": { "type": "string" },
              "providerID": { "type": "string" },
              "purpose": { "type": "string" },
              "whenToUse": { "type": "string" },
              "systemPrompt": { "type": "string" },
              "port": { "type": "number" },
              "supportsVision": { "type": "boolean" },
              "supportsWeb": { "type": "boolean" },
              "temperature": { "type": "number" },
              "tags": { "type": "array", "items": { "type": "string" } },
              "tools": {
                "type": "object",
                "additionalProperties": { "type": "boolean" }
              }
            }
          }
        ]
      }
    }
  }
}
